<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B型肝炎健保給付條件檢查工具</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h1>B型肝炎健保給付條件檢查工具</h1>

    <!-- 原本的條件區塊 -->
    <div class="section">
        <h2>基本檢查條件</h2>
        <div class="form-group">
            <label for="hbsag">HBsAg：</label>
            <select id="hbsag" name="hbsag">
                <option value="">請選擇</option>
                <option value="positive">陽性</option>
                <option value="negative">陰性</option>
            </select>
        </div>
        <div class="form-group">
            <label for="hbv_dna">HBV DNA 檢測：</label>
            <select id="hbv_dna" name="hbv_dna">
                <option value="">請選擇</option>
                <option value="detectable">可檢測</option>
                <option value="undetectable">不可檢測</option>
            </select>
        </div>
        <!-- 這裡可以加原本的其他條件... -->
    </div>

    <!-- 新增的特殊條件區塊 -->
    <div class="section">
        <h2>特殊條件：HBsAg(-) 且 Anti-HBc(+)</h2>
        <div class="form-group">
            <label for="hbsag_special">HBsAg：</label>
            <select id="hbsag_special" name="hbsag_special">
                <option value="">請選擇</option>
                <option value="negative">陰性</option>
                <option value="positive">陽性</option>
            </select>
        </div>
        <div class="form-group">
            <label for="antihbc">B型肝炎核心抗體 (Anti-HBc)：</label>
            <select id="antihbc" name="antihbc">
                <option value="">請選擇</option>
                <option value="positive">陽性</option>
                <option value="negative">陰性</option>
            </select>
        </div>

        <div id="hbsag_neg_antihbc_pos_conditions" style="display: none;">
            <p><strong>符合以下情況之一，可符合健保給付條件：</strong></p>
            <div class="checkbox-group">
                <input type="checkbox" id="non_liver_transplant_pre7" name="non_liver_transplant_pre7">
                <label for="non_liver_transplant_pre7">(1) 接受非肝之器官移植者，自移植前7天內可預防性使用，或接受非肝器官移植後，B型肝炎發作者，可長期使用。</label>
            </div>
            <div class="checkbox-group">
                <input type="checkbox" id="chemo_hbv_reactivation" name="chemo_hbv_reactivation">
                <label for="chemo_hbv_reactivation">(2) 接受癌症化學療法中，B型肝炎發作者，經照會消化系專科醫師同意後，可長期使用。</label>
            </div>
            <div class="checkbox-group">
                <input type="checkbox" id="liver_transplant_prophylaxis" name="liver_transplant_prophylaxis">
                <label for="liver_transplant_prophylaxis">(3) 接受肝臟移植者，可預防性使用。</label>
            </div>
            <div class="checkbox-group">
                <input type="checkbox" id="chemo_prevention" name="chemo_prevention">
                <label for="chemo_prevention">(4) 接受癌症化學療法，經照會消化專科醫師同意後，可於化療前1週開始給付使用，直至化療結束後6個月，以預防B型肝炎發作。(98/11/1)</label>
            </div>
        </div>
    </div>

    <!-- 檢查按鈕 -->
    <div class="section">
        <button id="checkButton">檢查是否符合給付條件</button>
    </div>

    <!-- 結果顯示 -->
    <div id="result" class="section" style="display:none;"></div>

    <script>
        // 原本的 JS 邏輯可以加在這裡...
        
        // 新增特殊條件顯示控制
        document.getElementById('hbsag_special').addEventListener('change', checkSpecialCondition);
        document.getElementById('antihbc').addEventListener('change', checkSpecialCondition);

        function checkSpecialCondition() {
            const hbsag = document.getElementById('hbsag_special').value;
            const antihbc = document.getElementById('antihbc').value;
            const section = document.getElementById('hbsag_neg_antihbc_pos_conditions');

            if (hbsag === 'negative' && antihbc === 'positive') {
                section.style.display = 'block';
            } else {
                section.style.display = 'none';
            }
        }

        // 範例檢查功能
        document.getElementById('checkButton').addEventListener('click', function () {
            let resultText = "檢查結果：";

            // 假設原本的檢查條件邏輯
            const hbsagValue = document.getElementById('hbsag').value;
            const hbvDnaValue = document.getElementById('hbv_dna').value;

            if (hbsagValue === 'positive' && hbvDnaValue === 'detectable') {
                resultText += "符合基本給付條件。";
            }

            // 特殊條件檢查
            const hbsagSpecial = document.getElementById('hbsag_special').value;
            const antihbcValue = document.getElementById('antihbc').value;

            if (hbsagSpecial === 'negative' && antihbcValue === 'positive') {
                const checkboxes = document.querySelectorAll('#hbsag_neg_antihbc_pos_conditions input[type="checkbox"]');
                let checkedAny = false;
                checkboxes.forEach(cb => { if (cb.checked) checkedAny = true; });
                if (checkedAny) {
                    resultText += " 符合特殊條件給付。";
                }
            }

            document.getElementById('result').innerText = resultText;
            document.getElementById('result').style.display = 'block';
        });
    </script>
</body>
</html>
